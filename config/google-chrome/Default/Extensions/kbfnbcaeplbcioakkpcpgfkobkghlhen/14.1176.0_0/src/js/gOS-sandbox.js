var e={41696:e=>{e.exports={}}},s={};function t(n){var i=s[n];if(void 0!==i)return i.exports;var o=s[n]={exports:{}};return e[n](o,o.exports,t),o.exports}(()=>{t(41696);class e{constructor(e){this._didReceiveReadyMessage=!1,this._onMessageListeners=[],this._pendingOutgoingMessages=[],this._onMessageFromAnySource=e=>{null!=e.source&&e.source===this._iframe.contentWindow&&this._onMessage(e)},this._flushPendingOutgoingMessages=()=>{if(this._didReceiveReadyMessage&&0!==this._pendingOutgoingMessages.length&&null!=this._iframe.contentWindow){for(const e of this._pendingOutgoingMessages)this._iframe.contentWindow.postMessage(e,this._iframeTargetOrigin);this._pendingOutgoingMessages.length=0}},this.__memoIframeTargetOrigin=null,this._iframe=e,self.addEventListener("message",this._onMessageFromAnySource)}get _iframeTargetOrigin(){var e;const s=this._iframe.src,t=this._iframe.getAttribute("sandbox");if((null===(e=this.__memoIframeTargetOrigin)||void 0===e?void 0:e.frameSrc)===s&&this.__memoIframeTargetOrigin.sandbox===t)return this.__memoIframeTargetOrigin.result;const n=self.origin,i=self.location.href,o=new URL(s,i),r=o.toString(),a="null"===n||"http:"===self.location.protocol&&"https:"===o.protocol||!1===(null==t?void 0:t.includes("allow-same-origin"))?"*":r;return this.__memoIframeTargetOrigin={frameSrc:s,sandbox:t,result:a},a}_onMessage(e){this._didReceiveReadyMessage=!0,this._onMessageListeners.forEach((s=>s(e.data))),this._flushPendingOutgoingMessages()}postMessage(e){null!=this._iframe.contentWindow&&this._didReceiveReadyMessage?(this._flushPendingOutgoingMessages(),this._iframe.contentWindow.postMessage(e,this._iframeTargetOrigin)):this._pendingOutgoingMessages.push(e)}onMessage(e){this._onMessageListeners.push(e)}dispose(){self.removeEventListener("message",this._onMessageFromAnySource),this._onMessageListeners.length=0,this._pendingOutgoingMessages.length=0}}var s;!function(e){e.postMessage="postMessage",e.setMessagePort="setMessagePort",e.setSource="setSource"}(s||(s={}));const n=["https://d3ttvzt45fz9bg.cloudfront.net","https://applet-bundles.grammarly.net"];const i={id:"0",type:"request",action:"ping",data:null};(function(){const t=void 0;try{const o=function(){const e=document.createElement("iframe");return e.style.border="none",e.style.width="100%",e.style.height="100%",e.allow="clipboard-read *; clipboard-write *",e}(),r=new e(o);document.body.appendChild(o);let a=null;const g=[],l=setInterval((()=>{var e;null===(e=o.contentWindow)||void 0===e||e.postMessage(i,"*")}),4);r.onMessage((e=>{clearInterval(l),null!=a?a.postMessage(e):g.push(e)}));const u=e=>{a=e,a.onmessage=()=>{null==t||t("unexpected incoming message from parent, use postMessage instead of message port")},a.onmessageerror=e=>{null==t||t("message port error",e)};for(const e of g)a.postMessage(e);return g.length=0,a};self.addEventListener("message",(e=>{if(null==self.parent||e.source!==self.parent)return;const i=function(e){const s=e.data;if(null!=s&&"object"==typeof s&&"string"==typeof s.type)return s}(e);if(null!=i)switch(i.type){case s.setSource:(function(e){try{const s=new URL(e).origin;return n.includes(s)}catch(e){return!1}})(i.url)&&(o.src=i.url);break;case s.postMessage:r.postMessage(i.data);break;case s.setMessagePort:if(!(i.port instanceof MessagePort))return void(null==t||t("invalid message port",i.port));null!=a&&(null==t||t("message port already set, overriding")),u(i.port)}})),self.parent.postMessage(i,"*")}catch(e){null==t||t(e)}})()})();