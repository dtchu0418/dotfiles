(self.webpackChunk=self.webpackChunk||[]).push([[274],{8977:(e,i,t)=>{t.r(i),t.d(i,{G2FeatureImpl:()=>di});var n=t(27378),r=t(14601),a=t(77176),s=t(98403),l=t(23239),o=t(57050),d=t(20236),c=t(55649),u=t(13718),h=t(19751),p=t(5114),g=t(62874),m=t(14505),v=t(89456),f=t(81964);class b{constructor(e){this._params=e,this._subs=new r.w,this._emphasizedParagraph=l.h.create(p.YP),this._paragraphById=l.h.create(new Map),this.paragraphs=this._params.paragraphHighlightService.highlights.view((e=>e.map((e=>({id:e.meta.paragraphId,text:e.meta.paragraphText,textRange:e.meta.paragraphTextRange,highlightRects:e.rects}))))),this.emphasizedParagraph=this._emphasizedParagraph.view(),this._subs.add(this._params.mouseData.pipe(u.U(g.S.hz30),h.skipBy(m.Z.eq),a.U((({client:e,offset:i})=>e&&i&&(0,f._N)(e,this._params.textFieldElement)?(0,o.zG)(p.ij(this.paragraphs.get().find((e=>e.highlightRects.some((e=>v.UL.contains(i,e))))))):p.YP))).subscribe(s.wW(this._emphasizedParagraph))),this._subs.add(this.paragraphs.pipe(a.U((e=>e.reduce(((e,i)=>e.set(i.id,i)),new Map)))).subscribe(s.wW(this._paragraphById)))}getParagraphById(e){return p.ij(this._paragraphById.get().get(e))}dispose(){this._subs.unsubscribe()}}const w=n.lazy((()=>Promise.all([t.e(2251),t.e(4754),t.e(274)]).then(t.bind(t,30494)).then((({ParagraphHighlightCollection:e})=>({default:e}))))),S=n.lazy((()=>Promise.all([t.e(2251),t.e(4754),t.e(274)]).then(t.bind(t,65211)).then((({SidelineCollection:e})=>({default:e})))));var _=t(32952),C=t(66310),R=t(2844),y=t(85985),I=t(23063),x=t(17343),E=t(97425),T=t(76974),M=t(48015),k=t(68435),F=t(52423);var L=t(36991);function z(e){return e.trim().split(/\s+/).filter((e=>""!==e)).length}function P(e,i){return e.map((e=>function(e,i){return(0,o.zG)(e.transformJSON.alternatives,p.UI((({alternatives:e,context:i})=>({alternative:e[0],context:i[0]}))),p.UI((({alternative:e,context:i})=>({ops:e.ops,context:i}))),p.UI((({ops:t,context:n})=>{let r=n.s,a=0;for(const e of t)L.s.match((e=>{L.s.isInsertString(e)&&(a+=z(e.insert),r+=e.insert.length)}),(e=>{const t=r+e.delete;a+=z(i.slice(r,t)),r=t}),(e=>{r+=e.retain}))(e);return a*((s=e.patternName).includes("MissingSpace")||s.includes("RedundantSpace")||s.includes("Clarity")||s.includes("Punctuation")?.5:s.includes("Formatting")||s.includes("Passive")||s.includes("Dialects")?.25:s.includes("Calliope")?.75:s.includes("Tone")||s.includes("Engagement")?.1:s.includes("RunOn")?2:s.includes("Style")?.5:s.includes("Fluency")||s.includes("FluencyRewrite")?.25:1);var s})),p.fS((()=>0)))}(e,i))).reduce(((e,i)=>e+i),0)}function A(e,i,t){if(e.text.length<50)return"none";const n=function(e,i){return e.filter((e=>e.transformJSON.highlights.some((e=>e.s>=i.start&&e.e<=i.end))))}(i,e.textRange);if(n.some((e=>e.patternName.startsWith("WritingExpert"))))return"purple";const r=P(n.filter((e=>!e.patternName.startsWith("WritingExpert"))),t),a=(s=e.text,Math.max(5,Math.min(10,z(s)/10)));var s;return Math.round(r)>=a?"red":"none"}class U{constructor(e){this._params=e,this._subs=new r.w,this._logger=c.Y.create("SidelineCollectionViewModelImpl"),this._sidelines=l.h.create([]),this._sidelineById=l.h.create(new Map),this._emphasizedSideline=l.h.create(p.YP),this._activeSideline=l.h.create(p.YP),this._pinnedSideline=l.h.create(p.YP),this._referenceElementBySidelineId=new Map,this._sidelineCardActiveNotifications=new _.xQ,this._deactivateSidelineSubs=new r.w,this._unpinSidelineSubs=new r.w,this.sidelines=this._sidelines.view(),this.emphasizedSideline=this._emphasizedSideline.view(),this.activeSideline=this._activeSideline.view(),this.pinnedSideline=this._pinnedSideline.view(),this._subs.add(this._params.paragraphService.paragraphs.pipe(C.w((e=>R.aj([this._params.integration.textFieldDOMRectTopLeft,this._params.textFieldLayout.rect.behavior.pipe(a.U((e=>e.client))),this._params.textFieldLayout.scroll.behavior,this._params.alerts]).pipe(a.U((([i,t,n,r])=>e.map((e=>{const a=function(e,i,t,n,r,a){const s=`g2-sideline-${e.textRange.start}-${e.textRange.end}`,l=(0,k.jr)(e.highlightRects);if(null===l)return null;const o={kind:"offsetPoint",...l},d=(0,F.Z)(o,i,t),c=A(e,r,a);return{id:s,paragraphId:e.id,anchorRect:d,textFieldDOMRectTopLeft:n,signalColor:c}}(e,t,n,i,r,this._params.textObserver.getCurrentTextMap().getPlainText());return null===a?(this._logger.warn("Failed to create sideline for paragraph; skipping.",{paragraph:e}),null):a})).filter(M.Nf))))))).subscribe(s.wW(this._sidelines))),this._subs.add(this._sidelines.pipe(a.U((e=>e.reduce(((e,i)=>e.set(i.id,i)),new Map)))).subscribe(s.wW(this._sidelineById)))}_doesSidelineIdMatchRelevantSideline(e,i){return(0,o.zG)(i,p.g_((()=>!1),(i=>e===i.id)))}_getSidelineById(e){return p.ij(this._sidelineById.get().get(e))}_deactivateSideline(e,i=!1){this._logger.debug("Deactivating sideline.",{sidelineId:e}),this._doesSidelineIdMatchRelevantSideline(e,this._activeSideline.get())?this._deactivateSidelineSubs=this._sidelineCardActiveNotifications.pipe(y.h((i=>i===e)),I.q(1),x.h(!1),E.L(i?0:1e3,T.of(!0))).subscribe((i=>{i?(this._logger.debug("Did not receive notification that corresponding sideline card is active, proceeding to deactivate sideline.",{sidelineId:e}),this._activeSideline.set(p.YP)):this._logger.debug("Received a notification that corresponding sideline card is active, won't deactivate sideline.",{sidelineId:e})})):this._logger.warn("Tried to deactivate sideline that is not active, this is a no-op.",{sidelineId:e})}_unpinSideline(e,i=!1){this._logger.debug("Unpinning sideline.",{sidelineId:e}),this._doesSidelineIdMatchRelevantSideline(e,this._pinnedSideline.get())?this._unpinSidelineSubs=this._sidelineCardActiveNotifications.pipe(y.h((i=>i===e)),I.q(1),x.h(!1),E.L(i?0:1e3,T.of(!0))).subscribe((i=>{i?(this._logger.debug("Did not receive notification that corresponding sideline card is active, proceeding to unpin sideline.",{sidelineId:e}),this._pinnedSideline.set(p.YP),this._deactivateSideline(e,!0)):this._logger.debug("Received a notification that corresponding sideline card is active, won't unpin sideline.",{sidelineId:e})})):this._logger.warn("Tried to unpin sideline that is not pinned, this is a no-op.",{sidelineId:e})}emphasizeSideline(e){this._logger.debug("Emphasizing sideline.",{sidelineId:e});const i=this._getSidelineById(e);p.pC(i)?this._emphasizedSideline.set(i):this._logger.warn("Tried to emphasized non-existing sideline, this is a no-op.")}unemphasizeSideline(e){this._logger.debug("Unemphasizing sideline.",{sidelineId:e}),this._doesSidelineIdMatchRelevantSideline(e,this._emphasizedSideline.get())?this._emphasizedSideline.set(p.YP):this._logger.warn("Tried to unemphasize sideline that is not emphasized, this is a no-op.",{sidelineId:e})}activateSideline(e){this._logger.debug("Activating sideline.",{sidelineId:e});const i=this._getSidelineById(e);p.pC(i)?(this._deactivateSidelineSubs.unsubscribe(),this._activeSideline.set(i),this.emphasizeSideline(e)):this._logger.warn("Tried to activate non-existing sideline, this is a no-op.",{sidelineId:e})}deactivateSideline(e){this._deactivateSideline(e)}pinSideline(e){this._logger.debug("Pinning sideline.",{sidelineId:e});const i=this._getSidelineById(e);p.pC(i)?(this._pinnedSideline.set(i),this.activateSideline(e)):this._logger.warn("Tried to pin non-existing sideline, this is a no-op.",{sidelineId:e})}unpinSideline(e){this._unpinSideline(e)}setSidelineReferenceElement(e,i){this._referenceElementBySidelineId.set(e,i)}getSidelineReferenceElement(e){return p.ij(this._referenceElementBySidelineId.get(e))}notifySidelineCardActive(e){this._sidelineCardActiveNotifications.next(e)}notifySidelineCardInactive(e,i){this._unpinSideline(e,i),this._deactivateSideline(e,i)}getSidelineById(e){return this._getSidelineById(e)}dispose(){this._subs.unsubscribe(),this._deactivateSidelineSubs.unsubscribe(),this._unpinSidelineSubs.unsubscribe()}}var N=t(78674),G=t(93508),V=t(54951),B=t(7604),O=t(68006),D=t(98017);function Y(e){let i=0,t=0;const n=[];for(;t<e.length;)"\n"===e.charAt(t)&&(i!==t&&n.push({start:i,end:t}),i=t+1),t++;return i!==t&&n.push({start:i,end:t}),n}class W{constructor(e){this._params=e,this._subs=new r.w,this._logger=c.Y.create("ParagraphHighlightServiceImpl"),this._highlightCollection=new V.C(this._params.geometryProvider,this._params.geometryLayout,(()=>this._params.textObserver.getCurrentTextMap()),(0,O.u)(),(0,B.WF)(this._params.textFieldLayout),(0,D.m)()),this.highlights=this._highlightCollection.geometry.view((e=>Array.from(e.values()))),this._subs.add(this._params.textObserver.contentChanges.async.pipe(y.h((e=>!e.deltaChange.isEmpty)),N.b(1e3),G.O(null),a.U((()=>{const e=this._params.textObserver.getCurrentTextMap().getPlainText();return{paragraphTextRanges:Y(e),fullText:e}}))).subscribe((({paragraphTextRanges:e,fullText:i})=>{this._logger.debug("Updating paragraph highlight collection.",{paragraphTextRanges:e});const t=Array.from(this._highlightCollection.geometry.get().keys());this._highlightCollection.removeHighlights(t);for(const t of e){const e=`g2-paragraph-${t.start}-${t.end}`,n=B.y$.Id.create(e);this._highlightCollection.addHighlight(n,t,{highlightId:n,paragraphId:e,paragraphText:i.slice(t.start,t.end),paragraphTextRange:t,alertId:e,highlightColor:null,highlightDisplayFormat:null,highlightLiveliness:null})}})))}dispose(){this._subs.unsubscribe()}}var H=t(61292),J=t(46297);class j{constructor(e){this._params=e,this._logger=c.Y.create("G2IntegrationGoogleDocs"),this.name="g2-google-docs-integration",this.textFieldDOMRectTopLeft=this._params.textFieldLayout.rect.behavior.pipe(a.U((e=>{const i=this._params.textFieldElement.querySelector(J.gv);if(null!==i){const{top:e,left:t,width:n,height:r}=i.getBoundingClientRect();return{top:e,left:t,width:n,height:r}}return this._logger.warn("Failed to retrieve canvas content element, defaulting to text field layout rect, which may not be appropriate as a text field DOM rect for documents with pages."),{top:e.client.top,left:e.client.left,...e.size}})))}}var $=t(18431);const q={[$.u.gmailCompose]:22,[$.u.gmailReply]:22,[$.u.gmailComposeStandalone]:22,[$.u.gmailComposeFullScreen]:22,[$.u.slackMessage]:10,[$.u.slackGenericQuill]:10,[$.u.slackThread]:10};class Q{_getLeftOffset(){const e=this._params.integrationName;return function(e){return e in q}(e)?function(e){return q[e]}(e):(this._logger.debug(`The corresponding offset value for the ${this._params.integrationName} integration was not found`),0)}constructor(e){this._params=e,this.name="g2-base-integration",this._logger=c.Y.create("G2IntegrationBase"),this.textFieldDOMRectTopLeft=this._params.textFieldLayout.rect.behavior.pipe(a.U((e=>({...e.client,left:e.client.left-this._getLeftOffset(),...e.size}))))}}var Z=t(10389);var K=t(8125),X=t(22232),ee=t(95195);const ie={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let te;const ne=new Uint8Array(16);function re(){if(!te&&(te="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!te))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return te(ne)}const ae=[];for(let e=0;e<256;++e)ae.push((e+256).toString(16).slice(1));function se(e,i=0){return ae[e[i+0]]+ae[e[i+1]]+ae[e[i+2]]+ae[e[i+3]]+"-"+ae[e[i+4]]+ae[e[i+5]]+"-"+ae[e[i+6]]+ae[e[i+7]]+"-"+ae[e[i+8]]+ae[e[i+9]]+"-"+ae[e[i+10]]+ae[e[i+11]]+ae[e[i+12]]+ae[e[i+13]]+ae[e[i+14]]+ae[e[i+15]]}const le=function(e,i,t){if(ie.randomUUID&&!i&&!e)return ie.randomUUID();const n=(e=e||{}).random||(e.rng||re)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,i){t=t||0;for(let e=0;e<16;++e)i[t+e]=n[e];return i}return se(n)};var oe,de=t(60797),ce=t(14717),ue=t(73915),he=t(59502),pe=t(59312);!function(e){e.Ideation="ideation",e.Rewrite="rewrite"}(oe||(oe={}));var ge,me,ve,fe,be=t(83257),we=t(18164),Se=$e((function(e){return je(_e(e),e.struct({}))(e)})),_e=$e((function(e){return e.intersect(e.partial({debugInfoJson:e.string}))(e.struct({id:e.number,correlationId:e.string}))})),Ce=$e((function(e){return je(_e(e),e.struct({}))(e)})),Re=($e((function(e){return Ve(e)})),$e((function(e){var i;return e.sum("valueType")(((i={}).string=Ie(e),i))}))),ye=$e((function(e){return e.struct({header:e.string,text:e.readonly(e.array(e.string))})})),Ie=$e((function(e){return e.intersect(e.partial({hint:ye(e)}))(e.struct({valueType:e.literal("string"),label:e.string,name:e.string}))})),xe=$e((function(e){return e.struct({id:e.string,label:e.string,args:e.readonly(e.array(Re(e)))})})),Ee=$e((function(e){var i;return e.sum("kind")(((i={}).id=Te(e),i.label=Me(e),i))})),Te=$e((function(e){return e.struct({kind:e.literal("id"),value:e.string})})),Me=$e((function(e){return e.struct({kind:e.literal("label"),value:e.string})})),ke=$e((function(e){return e.struct({name:e.string,value:e.string})})),Fe=$e((function(e){var i;return e.sum("kind")(((i={}).predefinedAction=Le(e),i.userPrompt=ze(e),i))})),Le=$e((function(e){return e.intersect(e.partial({args:e.readonly(e.array(ke(e)))}))(e.struct({kind:e.literal("predefinedAction"),actionIdentifier:Ee(e)}))})),ze=$e((function(e){return e.struct({kind:e.literal("userPrompt"),value:e.string})})),Pe=(ge=oe,me=Object.keys(ge).map((function(e){return ge[e]})),ve=me[0],fe=me.slice(1),$e((function(e){return e.literal.apply(e,(0,pe.ev)([ve],fe,!1))}))),Ae=$e((function(e){return e.intersect(e.partial({trustResult:e.boolean}))(e.struct({}))})),Ue=$e((function(e){return e.intersect(e.partial({onApplyAcceptAlerts:e.readonly(e.array(e.number))}))(e.intersect(e.partial({onApplyIgnoreAlerts:e.readonly(e.array(e.number))}))(e.struct({})))})),Ne=$e((function(e){return e.struct({start:e.number,end:e.number})})),Ge=$e((function(e){return e.struct({promptsRemaining:e.number,promptsAllocated:e.number,refillDate:e.string})})),Ve=$e((function(e){var i;return e.sum("action")(((i={})["disposable_cheetah:getActions"]=Be(e),i["disposable_cheetah:invokeCommand"]=Oe(e),i["disposable_cheetah:availableActions"]=De(e),i["disposable_cheetah:resultSuccess"]=Ye(e),i["disposable_cheetah:partialResult"]=We(e),i["disposable_cheetah:resultFailure"]=He(e),i))})),Be=$e((function(e){return je(Se(e),_e(e),e.intersect(e.partial({textScope:Ne(e)}))(e.struct({action:e.literal("disposable_cheetah:getActions"),rev:e.number,generationMode:Pe(e)})))(e)})),Oe=$e((function(e){return je(Se(e),_e(e),e.intersect(e.partial({textScope:Ne(e)}))(e.intersect(e.partial({meta:Ae(e)}))(e.struct({action:e.literal("disposable_cheetah:invokeCommand"),rev:e.number,generationMode:Pe(e),command:Fe(e)}))))(e)})),De=$e((function(e){return je(_e(e),Ce(e),e.struct({action:e.literal("disposable_cheetah:availableActions"),actions:e.readonly(e.array(xe(e)))}))(e)})),Ye=$e((function(e){return je(_e(e),Ce(e),e.struct({action:e.literal("disposable_cheetah:resultSuccess"),rewrittenText:e.string,rewrittenTextDelta:e.sensitiveDelta,usageLimits:Ge(e),meta:Ue(e)}))(e)})),We=$e((function(e){return je(_e(e),Ce(e),e.struct({action:e.literal("disposable_cheetah:partialResult"),rewrittenText:e.string}))(e)})),He=$e((function(e){return je(_e(e),Ce(e),e.struct({action:e.literal("disposable_cheetah:resultFailure"),error:e.string}))(e)})),Je=($e((function(e){var i;return e.sum("action")(((i={})["disposable_cheetah:getActions"]=Be(e),i["disposable_cheetah:invokeCommand"]=Oe(e),i))})),$e((function(e){var i;return e.sum("action")(((i={})["disposable_cheetah:getActions"]=Be(e),i["disposable_cheetah:invokeCommand"]=Oe(e),i["disposable_cheetah:availableActions"]=De(e),i["disposable_cheetah:resultSuccess"]=Ye(e),i["disposable_cheetah:partialResult"]=We(e),i["disposable_cheetah:resultFailure"]=He(e),i))})),$e((function(e){var i;return e.sum("action")(((i={})["disposable_cheetah:availableActions"]=De(e),i["disposable_cheetah:resultSuccess"]=Ye(e),i["disposable_cheetah:partialResult"]=We(e),i["disposable_cheetah:resultFailure"]=He(e),i))})));function je(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];return $e((function(i){return e.reduce((function(e,t){return i.intersect(t)(e)}))}))}function $e(e){return we.H(e)}(0,o.MZ)(ue.n);be.ov,be.id(),be.id(),be.id(),be.AG,be.dt,be.n_,be.r$,be.IM,be.IX,be.bc,be.wf,be.Sm,be.OT;const qe=ue.n((Qe=he.Schemable,function(e){return(0,pe.pi)((0,pe.pi)({},Qe),e)})({sensitiveDelta:he.id()}))(Je).is;var Qe;function Ze(e){return qe(e)&&"disposable_cheetah:resultSuccess"===e.action}function Ke(e){return qe(e)&&"disposable_cheetah:resultFailure"===e.action}function Xe(e){return{kind:"predefinedAction",actionIdentifier:{kind:"id",value:e}}}function ei(e){switch(e){case"improve":return Xe("VBarG2DefaultRewrite");case"calliope":return Xe("VBarG2Calliope");case"rephrase":return Xe("VBarG2Paraphrase");case"shorten":return Xe("VBarG2Shorter");case"friendly":return Xe("VBarG2Friendly");case"formal":return Xe("VBarG2Formal");default:(0,X.L0)(e)}}var ii=t(69243);const ti=ii.OT(ii.dt({explanation:ii.OT(ii.Z_),vbar_type:ii.OT(ii.G0([ii.i0("RED"),ii.i0("YELLOW"),ii.i0("GREEN")]))}));class ni{constructor(e){this._params=e,this._subs=new r.w,this._logger=c.Y.create("RewriteServiceImpl"),this._relevantCapiMessages=this._params.checkingService.pipe(de.oA,C.w((e=>e.capiMessages)),y.h((0,K.Kg)(Ze,Ke))),this._cachedRewriteIdMap=new Map,this._cachedRewriteMap=new Map,this._subs.add(this._relevantCapiMessages.subscribe((e=>this._handleServerMessage(e))))}_handleServerMessage(e){Ze(e)?this._handleServerMessageResultSuccess(e):Ke(e)?this._handleServerMessageResultFailure(e):(0,X.L0)(e)}_handleServerMessageResultSuccess(e){const i=this._cachedRewriteMap.get(e.correlationId);if(void 0===i)this._logger.warn("Received a successful result with unknown correlation ID.",{resultSuccessMessage:e});else{const t=(0,o.zG)(function(e){if(void 0===e.debugInfoJson)return ee.left("Debug info JSON undefined.");try{const i=JSON.parse(e.debugInfoJson);return(0,o.zG)(ti.decode(i),ee.mapLeft((e=>"Failed to decode debug info JSON."+(e[0].message?`Reason: ${e[0].message}.`:""))))}catch(e){return ee.left(`Failed to parse debug info JSON. Reason: ${e}.`)}}(e),ee.mapLeft((e=>this._logger.error(`Failed to extract debug info from successful result. Reason: ${e}.`))),p.Uo),n={kind:"ready",id:i.get().id,type:i.get().type,text:i.get().text,textRange:i.get().textRange,title:(0,o.zG)(t,p.UI((e=>e.explanation)),p.pF((()=>{return"improve"===(e=i.get().type)?"Improve your text":"rephrase"===e?"Rephrase your text":"calliope"===e?"Refine your text":"shorten"===e?"Condense wordy sections":"friendly"===e?"Use a friendly tone":"formal"===e?"Use formal language":void(0,X.L0)(e);var e}))),color:(0,o.zG)(t,p.UI((e=>function(e){return"GREEN"==e.vbar_type?"green":"RED"===e.vbar_type?"red":"YELLOW"===e.vbar_type?"yellow":void(0,X.L0)(e.vbar_type)}(e))),p.pF((()=>{return"improve"===(e=i.get().type)?"red":"rephrase"===e||"calliope"===e||"formal"===e||"shorten"===e||"friendly"===e?"green":void(0,X.L0)(e);var e}))),rewriteText:e.rewrittenText,rewriteDelta:e.rewrittenTextDelta};this._logger.debug("Received a successful result; updating rewrite.",{rewriteBefore:i.get(),rewriteAfter:n}),i.set(n)}}_handleServerMessageResultFailure(e){const i=this._cachedRewriteMap.get(e.correlationId);if(void 0===i)this._logger.warn("Received a failed result with unknown correlation ID.",{resultFailureMessage:e});else{const t={kind:"error",id:i.get().id,type:i.get().type,text:i.get().text,textRange:i.get().textRange,errorReason:e.error};this._logger.debug("Received a failed result; updating rewrite.",{rewriteBefore:i.get(),rewriteAfter:t}),i.set(t)}}async getRewrite(e,i,t,n=!0){const r=(0,ce.Wu)(i),a=`${e}-${t.start}-${t.end}-${r}`,s=this._cachedRewriteIdMap.get(a),o=void 0!==s?this._cachedRewriteMap.get(s):void 0,d=n&&void 0!==o&&"error"!==o.get().kind;if(d)return o;d||void 0===s||this._cachedRewriteMap.delete(s);const c=le();this._cachedRewriteIdMap.set(a,c);const u=l.h.create({kind:"loading",id:c,type:e,text:i,textRange:t});this._cachedRewriteMap.set(u.get().id,u);const h=this._params.checkingService.get();if(p.Wi(h))return this._logger.error("Failed to get rewrite. Checking service not initialized yet."),u.modify((e=>({...e,kind:"error",errorReason:"Failed to communicate with server."}))),u;const g=function(e){return{command:ei(e.type),correlationId:e.id,generationMode:oe.Rewrite,textScope:{start:e.textRange.start,end:e.textRange.end},debugInfoJson:JSON.stringify({trackBackendTimings:!0}),meta:{trustResult:!0}}}(u.get());try{const e=await h.value.sendMessage("disposable_cheetah:invokeCommand",g,!0,!1)();if(ee.isLeft(e))throw e.left.message;return u}catch(e){return this._logger.error("Failed to get rewrite. Error sending  disposable_cheetah:invokeCommand message to CAPI.",{error:e}),u.modify((e=>({...e,kind:"error",errorReason:"Failed to communicate with server."}))),u}}dispose(){this._subs.unsubscribe()}}const ri=n.lazy((()=>Promise.all([t.e(2251),t.e(4754),t.e(274)]).then(t.bind(t,46337)).then((({SidelineCard:e})=>({default:e})))));var ai=t(12126);function si(e,i,t,n,r){return(0,o.zG)(n,p.tS((i=>e.getSidelineById(i.sidelineId))),p.tS((e=>i.getParagraphById(e.paragraphId))),p.UI((e=>ai.D(t.getRewrite(r,e.text,e.textRange)).pipe(I.q(1),C.w(o.yR),a.U(p.G)))),p.pF((()=>T.of(p.YP))))}class li{constructor(e){var i;this._params=e,this._subs=new r.w,this._logger=c.Y.create("SidelineCardViewModelImpl"),this._visibleSidelineCard=l.h.create(p.YP),this._visibleSidelineCardImproveRewriteInfo=l.h.create(p.YP),this._visibleSidelineCardRephraseRewriteInfo=l.h.create(p.YP),this._visibleSidelineCardCalliopeRewriteInfo=l.h.create(p.YP),this._visibleSidelineCardShortenRewriteInfo=l.h.create(p.YP),this._visibleSidelineCardFriendlyRewriteInfo=l.h.create(p.YP),this._visibleSidelineCardFormalRewriteInfo=l.h.create(p.YP),this.visibleSidelineCard=this._visibleSidelineCard.view(),this.visibleSidelineCardImproveRewriteInfo=this._visibleSidelineCardImproveRewriteInfo.view(),this.visibleSidelineCardRephraseRewriteInfo=this._visibleSidelineCardRephraseRewriteInfo.view(),this.visibleSidelineCardCalliopeRewriteInfo=this._visibleSidelineCardCalliopeRewriteInfo.view(),this.visibleSidelineCardShortenRewriteInfo=this._visibleSidelineCardShortenRewriteInfo.view(),this.visibleSidelineCardFriendlyRewriteInfo=this._visibleSidelineCardFriendlyRewriteInfo.view(),this.visibleSidelineCardFormalRewriteInfo=this._visibleSidelineCardFormalRewriteInfo.view(),this._subs.add((i=this._params.sidelineCollectionViewModel,R.aj([i.activeSideline,i.pinnedSideline]).pipe(a.U((([e,i])=>(0,o.zG)(i,p.UI((e=>({sideline:e,isPinned:!0}))),p.wp((()=>(0,o.zG)(e,p.UI((e=>({sideline:e,isPinned:!1}))))))))),a.U(p.tS((({sideline:e,isPinned:t})=>(0,o.zG)(i.getSidelineReferenceElement(e.id),p.UI((i=>({sidelineId:e.id,isSidelinePinned:t,referenceElement:i}))))))))).subscribe(s.wW(this._visibleSidelineCard))),this._subs.add(this._visibleSidelineCard.pipe(C.w((e=>si(this._params.sidelineCollectionViewModel,this._params.paragraphService,this._params.rewriteService,e,"improve")))).subscribe(s.wW(this._visibleSidelineCardImproveRewriteInfo))),this._subs.add(this._visibleSidelineCard.pipe(C.w((e=>si(this._params.sidelineCollectionViewModel,this._params.paragraphService,this._params.rewriteService,e,"rephrase")))).subscribe(s.wW(this._visibleSidelineCardRephraseRewriteInfo)))}activateSidelineCard(e){this._logger.debug("Activate sideline card.",{sidelineCard:e}),this._params.sidelineCollectionViewModel.notifySidelineCardActive(e.sidelineId)}deactivateSidelineCard(e){this._logger.debug("Deactivate sideline card.",{sidelineCard:e}),this._params.sidelineCollectionViewModel.notifySidelineCardInactive(e.sidelineId)}applyRewrite(e,i){this._logger.debug("Apply rewrite.",{rewrite:e}),this._params.performReplacement({pos:e.textRange,value:e.rewriteText,oldValue:e.text}),this._params.sidelineCollectionViewModel.notifySidelineCardInactive(i.sidelineId,!0)}dispose(){this._subs.unsubscribe()}}var oi=t(3236);class di{constructor(e){this._params=e,this._subs=new r.w,this._logger=c.Y.create("G2FeatureImpl"),this._alertFilter=l.h.create(o.W8),this._integration=(0,H.a9)(this._params.integrationName)?new j({textFieldLayout:this._params.textFieldLayout,textFieldElement:this._params.textFieldElement}):new Q({textFieldLayout:this._params.textFieldLayout,integrationName:this._params.integrationName}),this._rewriteService=new ni({checkingService:this._params.checkingService}),this._paragraphHighlightService=new W({textObserver:this._params.textObserver,geometryProvider:this._params.geometryProvider,geometryLayout:this._params.geometryLayout,textFieldLayout:this._params.textFieldLayout}),this._paragraphService=new b({paragraphHighlightService:this._paragraphHighlightService,textFieldElement:this._params.textFieldElement,mouseData:this._params.mouseData}),this._sidelineCollectionViewModel=new U({paragraphService:this._paragraphService,integration:this._integration,textFieldLayout:this._params.textFieldLayout,textObserver:this._params.textObserver,alerts:this._params.alertProcessor.alerts.state.view((e=>Object.values(e).filter(M.Nf).filter(d.S.isTransformJsonCapiAlert)))}),this._replacementService=this._params.replacementServiceInjector.create(oi.P.g2),this._sidelineCardViewModel=new li({rewriteService:this._rewriteService,paragraphService:this._paragraphService,sidelineCollectionViewModel:this._sidelineCollectionViewModel,performReplacement:e=>this._replacementService.performReplacement(e)}),this.alertFilter=this._alertFilter.view(),this._logger.debug("G2 initialized on:",this._params.integrationName),this._subs.add(this._params.alertClassification.visibleInlineAlertsFilter.pipe(a.U((e=>i=>{return e(i)&&(t=i,d.S.isTransformJsonCapiAlert(t)&&t.outcome===Z.TC.correctness&&t.transformJSON.highlights.every((e=>"enclosing"!==e.type)));var t}))).subscribe(s.wW(this._alertFilter)))}get paragraphHighlightsUI(){return n.createElement(n.Suspense,{fallback:n.createElement(n.Fragment,null)},n.createElement(w,{paragraphs:this._paragraphService.paragraphs,activeSideline:this._sidelineCollectionViewModel.activeSideline,pinnedSideline:this._sidelineCollectionViewModel.pinnedSideline}))}get sidelinesUI(){return n.createElement(n.Suspense,{fallback:n.createElement(n.Fragment,null)},n.createElement(S,{sidelines:this._sidelineCollectionViewModel.sidelines,emphasizedParagraph:this._paragraphService.emphasizedParagraph,emphasizedSideline:this._sidelineCollectionViewModel.emphasizedSideline,activeSideline:this._sidelineCollectionViewModel.activeSideline,pinnedSideline:this._sidelineCollectionViewModel.pinnedSideline,onEmphasizeSideline:e=>this._sidelineCollectionViewModel.emphasizeSideline(e),onUnemphasizeSideline:e=>this._sidelineCollectionViewModel.unemphasizeSideline(e),onActivateSideline:e=>this._sidelineCollectionViewModel.activateSideline(e),onDeactivateSideline:e=>this._sidelineCollectionViewModel.deactivateSideline(e),onPinSideline:e=>this._sidelineCollectionViewModel.pinSideline(e),onUnpinSideline:e=>this._sidelineCollectionViewModel.unpinSideline(e),onMountSideline:(e,i)=>this._sidelineCollectionViewModel.setSidelineReferenceElement(e,i)}))}get sidelineCardUI(){return n.createElement(n.Suspense,{fallback:n.createElement(n.Fragment,null)},n.createElement(ri,{visibleSidelineCard:this._sidelineCardViewModel.visibleSidelineCard,visibleSidelineCardImproveRewriteInfo:this._sidelineCardViewModel.visibleSidelineCardImproveRewriteInfo,visibleSidelineCardRephraseRewriteInfo:this._sidelineCardViewModel.visibleSidelineCardRephraseRewriteInfo,onActivateSidelineCard:e=>this._sidelineCardViewModel.activateSidelineCard(e),onDeactivateSidelineCard:e=>this._sidelineCardViewModel.deactivateSidelineCard(e),onApplyRewrite:(e,i)=>this._sidelineCardViewModel.applyRewrite(e,i)}))}dispose(){this._subs.unsubscribe(),this._rewriteService.dispose(),this._paragraphHighlightService.dispose(),this._paragraphService.dispose(),this._sidelineCollectionViewModel.dispose(),this._sidelineCardViewModel.dispose()}}},30494:(e,i,t)=>{t.r(i),t.d(i,{ParagraphHighlightCollection:()=>u});var n=t(5114),r=t(8543),a=t(23239),s=t(54001),l=t(57050),o=t(27378),d=t(41572),c=t(14711);const u=({paragraphs:e,activeSideline:i,pinnedSideline:t})=>o.createElement(r.F.Fragment,null,a.h.combine(e,i,t,((e,i,t)=>o.createElement(d.L,{key:"g2",chunkName:"g2"},e.map((e=>e.highlightRects.map(((r,a)=>{return o.createElement("div",{key:`${e.id}-${a}`,...(0,s.Sh)(c.paragraphHighlightRect,(d=e.id,u=(0,l.zG)(t,n.UI((e=>e.paragraphId))),h=(0,l.zG)(i,n.UI((e=>e.paragraphId))),(0,l.zG)(u,n.UI((e=>e===d)),n.wp((()=>(0,l.zG)(h,n.UI((e=>e===d))))),n.fS((()=>!1)))?c.paragraphHighlightRectActive:void 0)),style:{top:r.top,left:r.left,width:r.width,height:r.height}});var d,u,h}))))))))},46337:(e,i,t)=>{t.r(i),t.d(i,{SidelineCard:()=>$});var n=t(8543),r=t(23239),a=t(27378),s=t(37869),l=t(17434);const o=({referenceElement:e,onMouseEnter:i,onMouseLeave:t,onFocus:n,onBlur:r,children:o})=>{const[d,c]=a.useState(null),{styles:u,attributes:h,state:p}=(0,s.D)(e,d,{placement:"bottom-start"});return a.createElement("div",{role:"dialog","aria-label":"Suggested rewrite dialog",tabIndex:0,ref:c,style:u.popper,className:l.sidelineCardPopper,onMouseEnter:i,onMouseLeave:t,onFocus:n,onBlur:r,...h.popper},o(null==p?void 0:p.placement))};var d=t(22232),c=t(73168);const u=()=>a.createElement("div",{className:c.sidelineCardRewriteLoadingSkeleton,"data-testid":"grammarly-g2-sideline-card-rewrite-loading-skeleton"},a.createElement("div",{className:c.sidelineCardRewriteLoadingSkeletonSignal}),a.createElement("div",{className:c.sidelineCardRewriteLoadingSkeletonContent},a.createElement("div",{className:c.sidelineCardRewriteLoadingSkeletonContentTitle}),a.createElement("div",{className:c.sidelineCardRewriteLoadingSkeletonContentText},a.createElement("div",{className:c.sidelineCardRewriteLoadingSkeletonContentTextLine}),a.createElement("div",{className:c.sidelineCardRewriteLoadingSkeletonContentTextLine}),a.createElement("div",{className:c.sidelineCardRewriteLoadingSkeletonContentTextLine}))));var h=t(6861),p=t(46354),g=t(40223),m=t(40938),v=t(98685);const f=({title:e,text:i})=>a.createElement("div",{className:h.sidelineCardRewriteSuccess,"data-testid":"grammarly-g2-sideline-card-rewrite-success"},a.createElement("div",{className:h.sidelineCardRewriteSuccessMain,"data-testid":"grammarly-g2-sideline-card-rewrite-success-main"},a.createElement(p.J,{size:"small",accessibilityLabel:"",icon:g.j}),a.createElement("div",{className:h.sidelineCardRewriteSuccessMainContent,"data-testid":"grammarly-g2-sideline-card-rewrite-success-main-content"},a.createElement(m.x,{className:h.sidelineCardRewriteSuccessMainContentTitle,as:"strong",color:"brand-default",variant:"text-small"},e),a.createElement(m.x,{as:"p",variant:"text-small",color:"base-subdued"},i))),a.createElement("div",{className:h.sidelineCardRewriteSuccessFooter,"data-testid":"grammarly-g2-sideline-card-rewrite-success-footer"},a.createElement(p.J,{size:"small",icon:v.p,accessibilityLabel:"Grammarly logo"})));var b=t(43043),w=t(54001),S=t(45552),_=t(31356),C=t(18657);const R=a.forwardRef((function(e,i){var t,n;const{buttonProps:r,isPressed:s,ref:l,inProgress:o,iconColor:d,variant:c}=(0,S.zT)(e,i),u=null!=(t=e.accessibilityLabel)?t:e.text,{isFocusVisible:h,focusProps:g}=(0,_.Fx)();let v=e.iconEnd,f=e.iconStart;"premium"===c&&(null!=e.iconEnd&&(v=C.O),null!=e.iconStart&&(f=C.O));const b="small"===e.size?"text-xsmall":"text-small";return a.createElement("button",{className:(0,S.gj)(e,s,o,h),tabIndex:null!=(n=e.tabIndex)?n:0,ref:l,...r,...g},null!=f&&a.createElement(p.J,{icon:f,accessibilityLabel:u,variant:d}),a.createElement(m.x,{as:"span",variant:b,weight:["primary","ghost","premium"].includes(c)?"bold":"normal"},e.text),null!=v&&a.createElement(p.J,{icon:v,accessibilityLabel:u,variant:d}),null!=e.shortcut&&"premium"!==c&&a.createElement(m.x,{variant:b,className:"gds-button-shortcut",as:"kbd"},e.shortcut))}));var y=t(77773),I=t(96833);function x(e){return"none"===e?void 0:"red"===e?b.sidelineCardRewriteReadyContentTitleRed:"purple"===e?b.sidelineCardRewriteReadyContentTitlePurple:"green"===e?b.sidelineCardRewriteReadyContentTitleGreen:"yellow"===e?b.sidelineCardRewriteReadyContentTitleYellow:(0,d.L0)(e)}const E=e=>{return a.createElement("div",{className:b.sidelineCardRewriteReady,"data-testid":"grammarly-g2-sideline-card-rewrite-ready"},a.createElement("div",{...(0,w.Sh)(b.sidelineCardRewriteReadySignal,(i=e.signalColor,"none"===i?void 0:"red"===i?b.sidelineCardRewriteReadySignalRed:"purple"===i?b.sidelineCardRewriteReadySignalPurple:"green"===i?b.sidelineCardRewriteReadySignalGreen:"yellow"===i?b.sidelineCardRewriteReadySignalYellow:(0,d.L0)(i))),"data-testid":"grammarly-g2-sideline-card-rewrite-ready-signal"}),a.createElement("div",{className:b.sidelineCardRewriteReadyContent,"data-testid":"grammarly-g2-sideline-card-rewrite-ready-content"},a.createElement(m.x,{...(0,w.Sh)(b.sidelineCardRewriteReadyContentTitle,x(e.signalColor)),as:"strong",variant:"text-small"},e.title),a.createElement(m.x,{as:"p",variant:"text-small"},e.newText),a.createElement("div",{className:b.sidelineCardRewriteReadyContentToolbar,"data-testid":"grammarly-g2-sideline-card-rewrite-ready-content-toolbar"},a.createElement("div",{className:b.sidelineCardRewriteReadyContentToolbarLeft,"data-testid":"grammarly-g2-sideline-card-rewrite-ready-content-toolbar-left"},a.createElement(R,{variant:"secondary",text:"apply"===e.applyCTA?"Apply all":"Insert",shortcut:"â†µ",size:"small",onClick:e.onApply})),a.createElement("div",{className:b.sidelineCardRewriteReadyContentToolbarRight,"data-testid":"grammarly-g2-sideline-card-rewrite-ready-content-toolbar-right"},a.createElement(y.h,{variant:"tertiary",accessibilityLabel:"Copy",icon:I.c,size:"small",onClick:e.onCopy}),a.createElement(p.J,{size:"small",icon:v.p,accessibilityLabel:"Grammarly logo"})))));var i},T=e=>a.createElement("div",{role:"region","aria-live":"polite","aria-busy":"loading"===e.kind,"aria-label":"loading"===e.kind?"Loading suggested rewrite":"Suggested rewrite","data-testid":"grammarly-g2-sideline-card-rewrite"},(()=>{switch(e.kind){case"loading":return a.createElement(u,null);case"ready":return a.createElement(E,{signalColor:e.signalColor,title:e.title,originalText:e.originalText,newText:e.newText,applyCTA:e.applyCTA,onApply:e.onApply,onCopy:e.onCopy});case"success":return a.createElement(f,{title:e.title,text:e.text});case"error":return null;default:(0,d.L0)(e)}})());var M=t(50995),k=t(94768),F=t(51869),L=t(90308),z=t(11559);const P=a.createContext({selectedTab:"",setSelectedTab(){},focusedTab:"",setFocusedTab(){},onChange(){},tabIds:[""]}),A=e=>`gds-tab-${e}`,U=e=>`gds-tab-panel-${e}`;const N=a.forwardRef((function(e,i){const{bottomBorder:t="default"}=e,n=(0,k.B3)(i),{setSelectedTab:r,setFocusedTab:s,onChange:l,focusedTab:o,tabIds:d}=a.useContext(P);return a.createElement("div",{ref:n,role:"tablist","aria-orientation":"horizontal","aria-label":e.accessibilityLabel,className:(0,F.W)("gds-tabs-list","none"===t&&"gds-tabs-border-none"),onKeyDown:e=>{const i=d.length,t=d.indexOf(o),n=e=>{var i;s(e),null==(i=document.getElementById(e))||i.focus()},a={ArrowRight:()=>{const e=d[(t+1)%i];n(e)},ArrowLeft:()=>{const e=d[(t-1+i)%i];n(e)},Enter:()=>{r(o),l(o)}}[e.key];a&&(e.preventDefault(),a())}},a.createElement(z.k,{gap:3,align:"end",style:{overflowX:"auto"}},e.children))})),G=a.forwardRef((function(e,i){const{selectedTab:t,setSelectedTab:n,setFocusedTab:r,onChange:s}=a.useContext(P),l=A(e.id),o=U(e.id),d=(0,k.B3)(i),c=t===l;return a.createElement("button",{"aria-selected":c,"aria-controls":o,className:"gds-tabs-tab-container",id:l,ref:d,role:"tab",tabIndex:c?0:-1,onClick:()=>{n(l),r(l),s(l)}},a.createElement("div",{className:"gds-tabs-tab","data-text":e.label},a.createElement(m.x,{weight:c?"bold":"normal",as:"span",variant:"text-small"},e.label)))})),V=a.forwardRef((function(e,i){const{selectedTab:t}=a.useContext(P),n=(0,k.B3)(i),r=A(e.id),s=U(e.id);let l=t===r;return a.useEffect((()=>{l=t===r}),[t]),l?a.createElement("div",{className:"gds-tabs-panel",role:"tabpanel",id:s,"aria-labelledby":r,ref:n,tabIndex:0},e.children):null})),B=(0,L.o)((e=>{const i=function(e){const i=[];return a.Children.forEach(e.children,(e=>{a.isValidElement(e)&&e.type===N&&a.Children.forEach(e.props.children,(e=>{a.isValidElement(e)&&e.type===G&&i.push(A(e.props.id))}))})),i}(e),{defaultSelectedTab:t,children:n}=e,r=t?A(t):i[0],[s,l]=a.useState(r),[o,d]=a.useState(r);return a.createElement("div",{className:"gds-tabs"},a.createElement(P.Provider,{value:{selectedTab:s,setSelectedTab:l,setFocusedTab:d,onChange:i=>{e.onChange&&e.onChange(i.replace(/gds-tab-/,""))},focusedTab:o,tabIds:i}},n))}),"Tabs",{Panel:V,TabList:N,Tab:G}),O=({shortenRewriteInfo:e,friendlyRewriteInfo:i,formalRewriteInfo:t})=>a.createElement(B.TabList,{accessibilityLabel:"Type of rewrite",bottomBorder:"none"},a.createElement(B.Tab,{id:"improve",label:"Improve"}),a.createElement(B.Tab,{id:"rephrase",label:"Rephrase"}),e?a.createElement(B.Tab,{id:"shorten",label:"Shorten"}):null,i?a.createElement(B.Tab,{id:"friendly",label:"Friendly"}):null,t?a.createElement(B.Tab,{id:"formal",label:"Formal"}):null),D=({improveRewriteInfo:e,rephraseRewriteInfo:i,shortenRewriteInfo:t,friendlyRewriteInfo:n,formalRewriteInfo:r})=>a.createElement(a.Fragment,null,a.createElement(B.Panel,{id:"improve"},a.createElement(T,{...e})),a.createElement(B.Panel,{id:"rephrase"},a.createElement(T,{...i})),t?a.createElement(B.Panel,{id:"shorten"},a.createElement(T,{...t})):null,n?a.createElement(B.Panel,{id:"friendly"},a.createElement(T,{...n})):null,r?a.createElement(B.Panel,{id:"formal"},a.createElement(T,{...r})):null),Y=({tabListPosition:e,improveRewriteInfo:i,rephraseRewriteInfo:t,shortenRewriteInfo:n,friendlyRewriteInfo:r,formalRewriteInfo:s})=>{const l=a.createElement(O,{shortenRewriteInfo:n,friendlyRewriteInfo:r,formalRewriteInfo:s}),o=a.createElement(D,{improveRewriteInfo:i,rephraseRewriteInfo:t,shortenRewriteInfo:n,friendlyRewriteInfo:r,formalRewriteInfo:s});return a.createElement("div",{className:M.sidelineCard,"data-testid":"grammarly-g2-sideline-card"},a.createElement(B,{defaultSelectedTab:"improve"},"top"===e?l:o,a.createElement("div",{className:M.sidelineCardHorizontalDivider}),"bottom"===e?l:o))};var W=t(5114),H=t(57050),J=t(8125);function j(e,i){if(W.Wi(e))return{kind:"loading"};if("loading"===e.value.kind)return{kind:"loading"};if("ready"===e.value.kind){if(e.value.text===e.value.rewriteText)return{kind:"success",title:"No errors detected",text:"To rephrase your text, select another option."};{const t=e.value;return{kind:"ready",title:t.title,signalColor:t.color,originalText:t.text,newText:t.rewriteText,applyCTA:"improve"===t.type?"apply":"insert",onApply:()=>i(t),onCopy:J.Q1}}}if("error"===e.value.kind)return{kind:"error"};(0,d.L0)(e.value)}const $=({visibleSidelineCard:e,visibleSidelineCardImproveRewriteInfo:i,visibleSidelineCardRephraseRewriteInfo:t,onActivateSidelineCard:s,onDeactivateSidelineCard:l,onApplyRewrite:d})=>a.createElement(n.F.Fragment,null,e.view((0,H.ls)(W.UI((e=>a.createElement(o,{referenceElement:e.referenceElement,onMouseEnter:()=>s(e),onMouseLeave:()=>{e.isSidelinePinned||l(e)},onFocus:()=>s(e),onBlur:()=>l(e)},(s=>a.createElement(n.F.Fragment,null,r.h.combine(i,t,((i,t)=>a.createElement(Y,{tabListPosition:"bottom"===s||"bottom-end"===s||"bottom-start"===s?"top":"bottom",improveRewriteInfo:j(i,(i=>d(i,e))),rephraseRewriteInfo:j(t,(i=>d(i,e)))})))))))),W.WG)))},65211:(e,i,t)=>{t.r(i),t.d(i,{SidelineCollection:()=>f});var n=t(5114),r=t(8543),a=t(23239),s=t(57050),l=t(27378),o=t(41572),d=t(54001),c=t(38527),u=t(46354),h=t(80463),p=t(22232);const g=l.forwardRef((function({emphasized:e,signalColor:i,fillColor:t,height:n,onClick:r,onMouseOver:a,onMouseOut:s,onFocus:o,onBlur:g},m){return l.createElement("button",{"data-testid":"grammarly-g2-sideline",...(0,d.Sh)(c.sideline,e?c.sidelineEmphasized:c.sidelineIdle,"blue"===t?c.sidelineFillBlue:void 0),style:{height:n},disabled:!e,onClick:e?r:void 0,onFocus:e?o:void 0,onBlur:e?g:void 0,onMouseOver:a,onMouseOut:s,"aria-label":"See rewrite suggestions",ref:m},"none"!==i&&l.createElement("div",{...(0,d.Sh)(c.sidelineSignal,(e=>{switch(e){case"none":return;case"red":return c.sidelineSignalRed;case"purple":return c.sidelineSignalPurple;case"green":return c.sidelineSignalGreen;case"yellow":return c.sidelineSignalYellow;default:(0,p.L0)(e)}})(i)),role:"status","aria-label":"Rewrite suggestions available"}),l.createElement(u.J,{...(0,d.Sh)(c.sidelineArrow,e?c.sidelineArrowEmphasized:c.sidelineArrowIdle),icon:h.b,accessibilityLabel:"",size:"small",variant:"none"!==t?"inverse":"default"}))}));var m=t(63954);function v(e,i,t,r,a){return(0,s.zG)(i,n.UI((i=>i===e.id)),n.fS((()=>(0,s.zG)(t,n.UI((i=>i===e.id)),n.fS((()=>!1)))||(0,s.zG)(r,n.UI((i=>i===e.id)),n.fS((()=>!1)))||(0,s.zG)(a,n.UI((i=>i===e.paragraphId)),n.fS((()=>!1))))))}const f=({sidelines:e,emphasizedParagraph:i,emphasizedSideline:t,activeSideline:d,pinnedSideline:c,onEmphasizeSideline:u,onUnemphasizeSideline:h,onActivateSideline:p,onDeactivateSideline:f,onPinSideline:b,onUnpinSideline:w,onMountSideline:S})=>l.createElement(r.F.Fragment,null,a.h.combine(e,i,t,d,c,((e,i,t,a,d)=>l.createElement(o.L,{key:"g2",chunkName:"g2"},e.map((e=>l.createElement(r.F.span,{key:e.id,className:m.sidelinePositioner,style:{top:e.anchorRect.top,left:e.textFieldDOMRectTopLeft.left,width:e.anchorRect.left-e.textFieldDOMRectTopLeft.left},onMouseEnter:()=>u(e.id),onMouseLeave:()=>h(e.id)},l.createElement(g,{fillColor:"none",emphasized:v(e,(0,s.zG)(d,n.UI((e=>e.id))),(0,s.zG)(a,n.UI((e=>e.id))),(0,s.zG)(t,n.UI((e=>e.id))),(0,s.zG)(i,n.UI((e=>e.id)))),signalColor:e.signalColor,height:e.anchorRect.height,onClick:()=>b(e.id),onFocus:()=>b(e.id),onBlur:()=>w(e.id),onMouseOver:()=>p(e.id),onMouseOut:()=>f(e.id),ref:i=>{i&&S(e.id,i)}}))))))))},46297:(e,i,t)=>{t.d(i,{$x:()=>s,F8:()=>g,Go:()=>r,Kt:()=>_,Lq:()=>d,Q2:()=>w,QR:()=>E,Qy:()=>f,Vk:()=>C,Wp:()=>n,XG:()=>a,_m:()=>h,d0:()=>c,f:()=>o,gH:()=>v,gL:()=>R,gv:()=>m,ij:()=>x,j5:()=>S,jW:()=>p,lO:()=>I,os:()=>b,rx:()=>y,uj:()=>u,y1:()=>l});const n=".kix-appview-editor",r=".docos-input",a=".docs-texteventtarget-iframe",s=".kix-cursor",l=".kix-cursor-caret",o="#docs-revisions-sidebar",d='#docs-toolbar-mode-switcher[aria-label="Viewing mode"]',c="#docs-toolbar-mode-switcher",u="edit-mode",h="suggest-mode",p="#titlebar-mode-indicator-container .titlebar-request-access-button",g="#titlebar-mode-indicator-container .kix-titlebar-request-access-button",m=".kix-canvas-tile-content",v="canvas.kix-canvas-tile-content:not(.docs-ui-unprintable *)",f=".kix-rotatingtilemanager:not(.docs-ui-unprintable *)",b=".kix-page-paginated.canvas-first-page",w="kix-page-canvas-compact-mode",S=".docs-horizontal-ruler",_=".docs-vertical-ruler",C="#fontSizeSelect input",R=".docs-ruler-background",y=".docs-ruler-background-inner",I=".docs-ruler-indent-first-line",x=".modal-dialog.docs-dialog .fatal-error-message",E='#docs-titlebar-share-client-button div[role="button"]'},18431:(e,i,t)=>{var n;t.d(i,{u:()=>n}),function(e){e.gmailReply="Gmail reply compose",e.gmailCompose="compose",e.gmailComposeStandalone="compose standalone",e.gmailComposeFullScreen="compose fullscreen",e.slackMessage="Slack Message",e.slackGenericQuill="Slack Generic Quill",e.slackThread="Slack Thread"}(n||(n={}))},14717:(e,i,t)=>{function n(e,i=0){return(i<<5)-i+(0|e)|0}function r(e,i=0){let t=i;for(const i of e)t=n(i.charCodeAt(0),t);return t}t.d(i,{Wu:()=>r,k3:()=>n})},83257:(e,i,t)=>{t.d(i,{AG:()=>a,IM:()=>d,IX:()=>c,OT:()=>m,Sm:()=>p,Vo:()=>g,bc:()=>u,dt:()=>l,id:()=>f,n_:()=>s,ov:()=>b,qm:()=>w,r$:()=>o,wf:()=>h});var n=t(18164),r=t(57050);function a(e){return{encode:function(i){return null===i?null:e.encode(i)}}}function s(e){return{encode:function(i){var t={};for(var n in e)t[n]=e[n].encode(i[n]);return t}}}var l=s;function o(e){return{encode:function(i){var t={};for(var n in e){var r=i[n];n in i&&(t[n]=void 0===r?void 0:e[n].encode(r))}return t}}}function d(e){return{encode:function(i){var t={};for(var n in i)t[n]=e.encode(i[n]);return t}}}function c(e){return{encode:function(i){return i.map(e.encode)}}}function u(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];return{encode:function(i){return e.map((function(e,t){return e.encode(i[t])}))}}}var h=function(e){return function(i){return{encode:function(t){return(0,n.U)(i.encode(t),e.encode(t))}}}};function p(e){return function(i){return{encode:function(t){return i[t[e]].encode(t)}}}}function g(e){var i=(0,n.H)(e);return{encode:function(e){return i().encode(e)}}}var m=r.yR,v=function(e,i){return{encode:function(t){return e.encode(i(t))}}};function f(){return{encode:r.yR}}var b="io-ts/Encoder",w={URI:b,contramap:v}},38527:e=>{e.exports={sideline:"G2vdT",sidelineEmphasized:"tw3gA",sidelineFillBlue:"ZsMnT",sidelineSignal:"E4ZA7",sidelineSignalRed:"NJZzh",sidelineSignalPurple:"bXbHB",sidelineSignalGreen:"sk2KB",sidelineSignalYellow:"qnAys",sidelineArrow:"Ihuz1",sidelineArrowIdle:"MpTE8",sidelineArrowEmphasized:"w8HJv"}},50995:e=>{e.exports={sidelineCard:"KetZV",sidelineCardHorizontalDivider:"d96oB"}},17434:e=>{e.exports={sidelineCardPopper:"m2vlI"}},73168:e=>{e.exports={sidelineCardRewriteLoadingSkeleton:"AZpqD",sidelineCardRewriteLoadingSkeletonSignal:"QmlkU",blink:"ME70b",sidelineCardRewriteLoadingSkeletonContent:"pCdaZ",sidelineCardRewriteLoadingSkeletonContentTitle:"njaNp",sidelineCardRewriteLoadingSkeletonContentText:"tFJmW",sidelineCardRewriteLoadingSkeletonContentTextLine:"CUydw"}},43043:e=>{e.exports={sidelineCardRewriteReady:"aC0Qq",sidelineCardRewriteReadySignal:"dwkGU",sidelineCardRewriteReadySignalRed:"j4c27",sidelineCardRewriteReadySignalPurple:"PAZPX",sidelineCardRewriteReadySignalGreen:"RQGEa",sidelineCardRewriteReadySignalYellow:"b0g8Y",sidelineCardRewriteReadyContent:"ANoVu",sidelineCardRewriteReadyContentTitle:"JruGr",sidelineCardRewriteReadyContentTitleRed:"u62sm",sidelineCardRewriteReadyContentTitlePurple:"O2bNp",sidelineCardRewriteReadyContentTitleGreen:"f5U00",sidelineCardRewriteReadyContentTitleYellow:"i_77I",sidelineCardRewriteReadyContentToolbar:"AkoCa",sidelineCardRewriteReadyContentToolbarLeft:"Fl51m",sidelineCardRewriteReadyContentToolbarRight:"UPwBp"}},6861:e=>{e.exports={sidelineCardRewriteSuccess:"qCfRi",sidelineCardRewriteSuccessMain:"EHpcl",sidelineCardRewriteSuccessMainContent:"YnX7U",sidelineCardRewriteSuccessMainContentTitle:"KYYEg",sidelineCardRewriteSuccessFooter:"mKGH0"}},14711:e=>{e.exports={paragraphHighlightRect:"gvgre",paragraphHighlightRectActive:"oE69j"}},63954:e=>{e.exports={sidelinePositioner:"lx6ct"}},80463:(e,i,t)=>{t.d(i,{b:()=>r});var n=t(27378);const r=(0,t(91961).I)("color",(({title:e,titleId:i,desc:t,descId:r,...a})=>n.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",viewBox:"0 0 16 16","aria-hidden":"true",stroke:"transparent","aria-labelledby":i,"aria-describedby":r,...a},t?n.createElement("desc",{id:r},t):null,e?n.createElement("title",{id:i},e):null,n.createElement("path",{stroke:"#646B81",strokeLinecap:"round",d:"m2 5 6 6 6-6"}))))}}]);